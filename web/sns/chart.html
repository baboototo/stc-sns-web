<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>STC</title>
</head>
<body>

<div id="wordCloud" style="height:300px; background-color: #79ace9"></div>
<div id="channelTotal" style="height:300px; background-color: #999999"></div>

<script type="text/javascript" src="js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript" src="js/chart.js"></script>
<script type="text/javascript" src="js/chartOptions.js"></script>
<script type="text/javascript" src="js/chartUtil.js"></script>
<script type="text/javascript">

    var keyword = "문화";

    function initChart() {
        initWordCloudChart();
        initChannelTotal();
    }

    function initChannelTotal() {
        requestGet("http://localhost/api/pie/v1.0/channelTotal?keyword=" + keyword, createChannelTotal);

    }

    function createChannelTotal(data) {
        var dom = document.getElementById("channelTotal");
        var myChart = echarts.init(dom);
        var channelSum = chartValueSum(data.seriesData);

        var option = {
            title: {
                text: channelSum + "건",
                x: 'center',
                y: 'center',
                textAlign: 'center',
                textVerticalAlign: 'middle',
                textStyle : {
                    color: '#000000',
                    fontWeight : 'bold'
                }
            },
            tooltip : {
                trigger: 'item',
                formatter: "{b}<br/>{c}건 ({d}%)",
                textStyle: {
                    align: 'center'
                }
            },

            legend: {
                orient : 'horizontal',
                x : 'center',
                y: 'bottom',
                data: data.legendData
            },
            toolbox: {
                show : true,
                feature : {
                    mark : {show: true},
                    dataView : {show: true, readOnly: false},
                    magicType : {
                        show: true,
                        type: ['pie', 'funnel'],
                        option: {
                            funnel: {
                                x: '25%',
                                width: '50%',
                                funnelAlign: 'center',
                                max: channelSum
                            }
                        }
                    },
                    restore : {show: true},
                    saveAsImage : {show: true}
                }
            },
            calculable : true,
            series : [
                {
                    type:'pie',
                    radius : ['50%', '70%'],
                    itemStyle : {
                        normal : {
                            label : {
                                show : true,
                                formatter:  '{b}\n{c}건 ({d}%)'
                            },
                            labelLine : {
                                show : true
                            }
                        },
                    },
                    data: data.seriesData
                }
            ]
        };

        if (option && typeof option === "object") {
            myChart.setOption(option, true);
        }
    }




    /*****************************************************************************************************************
     * Create Word Cloud
     */
    function initWordCloudChart() {
        requestGet("http://localhost/api/wordCloud/v1.0/words?keyword=" + keyword, createWordCloudChart);
    }
    /**
     * 워드클라우드 차트 생성
     * @param data
     */
    function createWordCloudChart(data) {
        var dom = document.getElementById("wordCloud");
        var myChart = echarts.init(dom);

        var chartTitle = new ChartTitle("제목");
        chartTitle.setSubText("만나서 반가워");
        chartTitle.setLink("https://www.daum.net");
        chartTitle.setPosition("center");

        var option = {
            title: option,
            tooltip: {
                show: false
            },
            series: [{
                name: 'Google Trends',
                type: 'wordCloud',
                size: ['50%', '50%'],
                textRotation : [0, 0, 0, 0],
                textPadding: 15,
                autoSize: {
                    enable: true,
                    minSize: 5
                },
                data: addChartDataItemStyleColor(data)
            }]
        };
        if (option && typeof option === "object") {
            myChart.setOption(option, true);
        }
    }

</script>


</body>
</html>